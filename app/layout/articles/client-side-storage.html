{% extends "article.html" %}{% block article %}<h1 id="client-side-storage">Client Side Storage</h1>
<p>It’s safe to say that Cookies are a cornerstone of web infrastructure, without them we’d lose much of what we now take for granted like shopping carts, personalised experiences and handy ‘remember me’ features.</p>
<p>And even though the mighty Cookie isn’t going anywhere, with the wide adoption of HTML5 and Web Storage there are now some truly fantastic alternatives available.</p>
<p>Virtually all modern browsers (including IE8+) support Web Storage, which can be broken down into two slightly different variations, Session Storage and Local Storage. This article will explore some of the key differences and use cases for each.</p>
<h2 id="the-tl-dr-comparison">The TL;DR Comparison</h2>
<p>This table provides a quick comparison between Cookies, Local Storage and Session Storage.</p>
<table class="table table-striped">
<tr>
<th width="25%">
</th>

<th width="25%">
Cookies
</th>

<th width="25%">
Local Storage
</th>

<th width="25%">
Session Storage
</th>
</tr>

<tr>
<th>
Browser Support
</th>

<td>
All major browsers
</td>

<td>
Modern browsers &amp; IE8+
</td>

<td>
Modern browsers &amp; IE8+
</td>
</tr>

<tr>
<th>
Sent Over HTTP
</th>

<td>
Yes
</td>

<td>
No
</td>

<td>
No
</td>
</tr>

<tr>
<th>
Sub Domain Access
</th>

<td>
Configurable
</td>

<td>
No
</td>

<td>
No
</td>
</tr>

<tr>
<th>
Browser Tabs
</th>

<td>
All Tabs
</td>

<td>
All Tabs
</td>

<td>
Single Tab
</td>
</tr>

<tr>
<th>
Storage
</th>

<td>
Limited
</td>

<td>
Around 5MB
</td>

<td>
Around 5MB
</td>
</tr>

<tr>
<th>
Expiry
</th>

<td>
Expiry date or on tab close (configurable)
</td>

<td>
No expiry date
</td>

<td>
On tab close
</td>
</tr>
</table>


<h2 id="cookies">Cookies</h2>
<p><strong>Advantages</strong></p>
<ul>
<li>Flexible and configurable</li>
<li>Supported by virtually every conceivable browser</li>
<li>Easily accessible server side</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Sent along with every HTTP request which increases bandwidth</li>
<li>Limited storage space</li>
<li>Susceptible to man in the middle and XSS attacks unless configured properly</li>
</ul>
<h3 id="how-it-works">How It Works</h3>
<p>Most server side frameworks and languages will provide the ability to create cookies, while the implementation will differ, the following options should be available:</p>
<p><strong>Expiry</strong> - Cookies can be set to expire either at the end of the session (i.e. when the user closes the relevant tab or browser) or on a specific date at a specific time. This is particularly useful when it comes to using cookies for varying purposes. A shopping cart may only need to remain populated during a single session, while an authentication ‘remember me’ cookie might be handy for a few days.</p>
<p><strong>HTTP Only</strong> - Setting this flag when creating a cookie will mean that the cookie can only be accessed by HTTP headers and not programmatically via Javascript. This helps secure the data held in the cookie against XSS attacks.</p>
<p><strong>Domain</strong> - A cookie can be set to be accessible across sub-domains of the same domain. This can help persist user data throughout various parts of the same website (e.g. support.domain.com and shop.domain.com)</p>
<p><strong>Secure</strong> - A secure cookie will instruct the browser to only transmit the cookie over a secure connection (https:// instead of http://) thus making the data within it much harder to intercept as part of a man-in-the-middle attack.</p>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li>When client side storage is mission critical and there’s even a remote chance of the application being accessed in browsers older than IE8</li>
<li>When dealing with authentication over HTTPS</li>
<li>When server side script needs easy access to client side storage (e.g. managing shopping basket contents)</li>
</ul>
<h2 id="local-storage">Local Storage</h2>
<p><strong>Advantages</strong></p>
<ul>
<li>Ample storage (typically up to 5MB per domain)</li>
<li>Beautifully easy to work with</li>
<li>More secure by default, storage only accessible and writable by client side code on the same domain</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Javascript checks and fallbacks needed to ensure widest browser support</li>
<li>Data not available server side</li>
<li>Data cannot be shared with other sub-domains</li>
</ul>
<h3 id="how-it-works">How It Works</h3>
<p>Local Storage is a key-value type storage and is accessible purely by client side code, the only way in which a server can access the data held in Local Storage is if it’s sent via an AJAX request from the client to the server.</p>
<p>Using Javascript to manage local storage is nothing but delightful thanks to a really simple API.</p>
<pre><code><span class="hljs-comment">// Check for storage capability</span>
<span class="hljs-selector-tag">if</span> (typeof Storage !== undefined) {
    <span class="hljs-comment">// Set a value</span>
    localStorage<span class="hljs-selector-class">.setItem</span>(<span class="hljs-string">"key"</span>, <span class="hljs-string">"value"</span>);
    <span class="hljs-comment">// Get a value</span>
    localStorage<span class="hljs-selector-class">.getItem</span>(<span class="hljs-string">"key"</span>);
} <span class="hljs-selector-tag">else</span> {
    <span class="hljs-comment">// Cookies it is!</span>
}
</code></pre><p>In many cases it can be handy to store JSON objects in storage, and this can be done simply by stringifying:</p>
<pre><code><span class="hljs-comment">// Set</span>
<span class="hljs-keyword">var</span> storedObject = {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Matt"</span>,
    <span class="hljs-string">"favouriteFruit"</span>: <span class="hljs-string">"Apple"</span>,
    <span class="hljs-string">"hadForBreakfast"</span>: <span class="hljs-string">"Weetabix"</span>
};
localStorage.setItem(<span class="hljs-string">"storedObject"</span>, <span class="hljs-built_in">JSON</span>.stringify(storedObject));

<span class="hljs-comment">// Get</span>
<span class="hljs-keyword">var</span> retrievedObject = localStorage.getItem(storedObject)
<span class="hljs-built_in">JSON</span>.parse(retrievedObject);
</code></pre><p>Data held in local storage will persist across browser tabs and sessions, and will typically not expire until the user decides to clear it.</p>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li>When client side storage is a bonus and/or fallbacks are in place to support older browsers</li>
<li>When there’s a requirement to store larger amounts of serialised data client side</li>
<li>When the server does not need to directly access data held client side</li>
</ul>
<h2 id="session-storage">Session Storage</h2>
<p><strong>Advantages</strong></p>
<ul>
<li>Persists across page reloads but not new tabs (allowing for unique data on a per-tab basis)</li>
<li>Most browsers restore session data when recovering from a crash</li>
<li>As easy to work with as Local Storage</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Javascript checks and fallbacks needed to ensure widest browser support</li>
<li>Data not available server side</li>
</ul>
<h3 id="how-it-works">How It Works</h3>
<p>Session Storage can be used in exactly the same way as Local Storage - simply by replacing
<code>localStorage</code> with <code>sessionStorage</code>.</p>
<p>Again, the server cannot access this data, so any usage of it either needs to be kept client side or sent to the server via AJAX requests.</p>
<p>Session Storage will not persist across tabs and will be removed when the tab or browser is cloesd. The general exception to this rule is
that most browsers will restore session data when recovering from a crash.</p>
<h3 id="use-cases">Use Cases</h3>
<ul>
<li>When client side storage is a bonus and/or fallbacks are in place to support older browsers</li>
<li>When there is a benefit to having separate data for each tab of the website / application (e.g. for analytics tracking or unique user identification)</li>
<li>When the server does not need to directly access the data held client side</li>
</ul>
<h2 id="the-bottom-line">The Bottom Line</h2>
<p>If supporting older browsers is still a must then there
is no escaping the fact that Cookies are still essential.
But in many cases, especially when creating web
<em>applications</em>, utilising Web Storage can often be a more effective approach considering the simplicity of the implementation, improved security and smaller HTTP headers.</p>
{% endblock %}